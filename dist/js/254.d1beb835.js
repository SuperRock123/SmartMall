"use strict";(self["webpackChunksmart_mall"]=self["webpackChunksmart_mall"]||[]).push([[254],{254:function(t,o,s){s.r(o),s.d(o,{default:function(){return h}});s(4114);var a=function(){var t=this,o=t._self._c;return o("div",{staticClass:"product"},[o("van-nav-bar",{attrs:{title:"商品详情","left-text":"返回","left-arrow":""},on:{"click-left":function(o){return t.$router.go(-1)}}}),o("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3}},t._l(t.goods.goods_images,(function(s){return o("van-swipe-item",{key:s.file_id},[o("img",{attrs:{src:s.external_url,alt:""},on:{click:t.imageDetail}})])})),1),o("van-goods-action",[o("van-goods-action-icon",{attrs:{icon:"wap-home-o",text:"主页",dot:""},on:{click:function(o){return t.$router.push("/")}}}),o("van-goods-action-icon",{attrs:{icon:"cart-o",text:"购物车",badge:t.cartTotal},on:{click:function(o){return t.$router.push("/cart")}}}),o("van-goods-action-button",{attrs:{type:"warning",text:"加入购物车"},on:{click:t.addToCart}}),o("van-goods-action-button",{attrs:{type:"danger",text:"立即购买"},on:{click:t.buynow}})],1),o("div",{staticClass:"price"},[t._v(" ￥"+t._s(t.goods.goods_price_min)+" "),o("span",{staticClass:"minPrice"},[t._v(t._s(t.goods.goods_price_max))]),o("span",{staticClass:"sales"},[t._v("已售"+t._s(t.goods.goods_sales)+"件")])]),o("div",{staticClass:"name",domProps:{textContent:t._s(t.goods.goods_name)}}),o("div",{staticClass:"service"},[o("span",[o("van-icon",{attrs:{name:"certificate",color:"#ee0a24",size:"20"}}),t._v(" 七天无理由退货 ")],1),o("span",[o("van-icon",{attrs:{name:"certificate",color:"#ee0a24",size:"20"}}),t._v(" 48小时发货 ")],1),o("van-icon",{staticClass:"right_arrow",attrs:{name:"arrow"}})],1),o("div",{staticClass:"comment"},[o("p",[o("span",[t._v("商品评价（"+t._s(t.commentsOverview.all)+"条）")]),o("span",{on:{click:t.toReviewDetailPage}},[t._v(" 更多评价 "),o("van-icon",{attrs:{name:"arrow"}})],1)]),t._l(t.comments,(function(s){return o("div",{key:s.comment_id,staticClass:"review"},[null==s.user.avatar_url?o("van-icon",{attrs:{name:"contact-o"}}):o("img",{attrs:{src:s.user.avatar_url}}),o("span",[t._v(t._s(s.user.nick_name))]),o("van-rate",{attrs:{value:s.score/2,size:16,color:"#ffd21e","void-icon":"star","void-color":"#eee",readonly:""}}),o("div",{staticClass:"content"},[t._v(" "+t._s(s.content)+" ")]),o("div",{staticClass:"time"},[t._v(t._s(s.create_time))])],1)}))],2),o("van-action-sheet",{attrs:{title:"加入购物车"},model:{value:t.show,callback:function(o){t.show=o},expression:"show"}},[o("div",{staticClass:"content"},[o("img",{attrs:{src:t.goods.goods_image}}),o("div",{staticClass:"price"},[t._v("￥"+t._s(t.goods.goods_price_min))]),o("div",{staticClass:"stock"},[t._v("库存"+t._s(t.goods.stock_total))]),o("p",[o("span",[t._v("数量")]),o("countBox",{staticClass:"countBox",model:{value:t.productCount,callback:function(o){t.productCount=o},expression:"productCount"}})],1),o("p",{staticClass:"footer"},[o("addButton",{staticClass:"addButton",on:{"button-clicked":t.handleAddToCart},scopedSlots:t._u([{key:"content",fn:function(){return[t._v("加入购物车")]},proxy:!0}])})],1)])]),o("van-action-sheet",{attrs:{title:"立即购买"},model:{value:t.showPurchase,callback:function(o){t.showPurchase=o},expression:"showPurchase"}},[o("div",{staticClass:"content"},[o("img",{attrs:{src:t.goods.goods_image}}),o("div",{staticClass:"price"},[t._v("￥"+t._s(t.goods.goods_price_min))]),o("div",{staticClass:"stock"},[t._v("库存"+t._s(t.goods.stock_total))]),o("p",[o("span",[t._v("数量")]),o("countBox",{staticClass:"countBox",model:{value:t.productCount,callback:function(o){t.productCount=o},expression:"productCount"}})],1),o("p",{staticClass:"footer"},[o("addButton",{staticClass:"addButton",on:{"button-clicked":t.handleBuynow},scopedSlots:t._u([{key:"content",fn:function(){return[t._v("立即购买")]},proxy:!0}])})],1)])])],1)},e=[],n=s(8950),i=s(2900),c=s(2320),r=s(9652),d=s(3054),u=s(383),l={name:"ProductIndex",components:{[i.A.Component.name]:i.A.Component,countBox:d.A,addButton:u.A},data(){return{goods:{},comments:{},commentsOverview:{},show:!1,productCount:1,cartTotal:void 0,showPurchase:!1}},async created(){this.goods=await(0,n.FH)(this.$route.query.goodsId),this.goods=this.goods.data.detail,this.commentsOverview=await(0,n.my)(this.$route.query.goodsId),this.commentsOverview=this.commentsOverview.data.total,this.comments=await(0,n.b8)(this.$route.query.goodsId,5),this.comments=this.comments.data.list},methods:{imageDetail(){const t=[];this.goods.goods_images.forEach((o=>{t.push(o.external_url)})),(0,i.A)({images:t,closeable:!0})},toReviewDetailPage(){this.$router.push(`/reviewDetail?goodsId=${this.$route.query.goodsId}`)},addToCart(){this.show=!0},buynow(){this.showPurchase=!0},async handleBuynow(){!1!==this.$userLocalStorage.getLocalState()?this.$router.push(`/submit?goodsId=${this.goods.goods_id}&goodsNum=${this.productCount}&goodsSku=${this.goods.skuList[0].goods_sku_id}`):c.A.confirm({title:"您还没有登录哦:(",confirmButtonText:"去登录",cancelButtonText:"再逛逛"}).then((()=>{this.$router.replace(`/login?goodsId=${this.$route.query.goodsId}`)})).catch((()=>{}))},async handleAddToCart(){if(!1===this.$userLocalStorage.getLocalState())return void c.A.confirm({title:"您还没有登录哦:(",confirmButtonText:"去登录",cancelButtonText:"再逛逛"}).then((()=>{this.$router.replace(`/login?goodsId=${this.$route.query.goodsId}`)})).catch((()=>{}));const t=await(0,r.zT)(this.goods.goods_id,this.productCount,this.goods.skuList[0].goods_sku_id);200===t.status&&(this.cartTotal=t.data.cartTotal)}}},m=l,g=s(1656),v=(0,g.A)(m,a,e,!1,null,"59e86ff5",null),h=v.exports},8950:function(t,o,s){s.d(o,{FH:function(){return e},b8:function(){return i},my:function(){return n}});var a=s(5720);function e(t){return a.A.get("/goods/detail",{params:{goodsId:t}})}function n(t){return a.A.get("/comment/total",{params:{goodsId:t}})}function i(t,o){return a.A.get("/comment/listRows",{params:{goodsId:t,limit:o}})}}}]);
//# sourceMappingURL=254.d1beb835.js.map