"use strict";(self["webpackChunksmart_mall"]=self["webpackChunksmart_mall"]||[]).push([[979],{3979:function(t,s,e){e.r(s),e.d(s,{default:function(){return m}});var o=function(){var t=this,s=t._self._c;return s("div",{staticClass:"order-checkout"},[s("van-nav-bar",{attrs:{title:"提交订单","left-text":"返回","left-arrow":""},on:{"click-left":function(s){return t.$router.go(-1)}}}),s("section",{staticClass:"address",on:{click:t.handleClickAddress}},[s("h2",{staticClass:"section-title"},[t._v("收货地址")]),s("p",{staticClass:"address-details"},[t._v(t._s(t.address.first))]),s("p",{staticClass:"address-details"},[t._v(t._s(t.address.second))]),s("van-icon",{attrs:{name:"arrow",color:"rgb(137 137 137 / 78%)",size:"40"}})],1),void 0!==t.buynow.product.goodsId?s("div",{staticClass:"item"},[s("img",{attrs:{src:t.buynow.product.goods_image,title:t.buynow.product.goods_name}}),s("div",{staticClass:"product"},[s("div",{staticClass:"des"},[t._v(t._s(t.buynow.product.goods_name))]),s("span",{staticClass:"price"},[t._v("￥"+t._s(t.buynow.product.goods_price_min))]),s("span",{staticClass:"quatity"},[t._v("x"+t._s(t.buynow.goodsNum))])])]):t._e(),t._l(t.selectedItems,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:void 0===t.buynow.product.goodsId,expression:"buynow.product.goodsId===undefined"}],key:e.goods_id,staticClass:"item"},[s("img",{attrs:{src:e.goods.goods_image,title:e.goods.goods_name}}),s("div",{staticClass:"product"},[s("div",{staticClass:"des"},[t._v(t._s(e.goods.goods_name))]),s("span",{staticClass:"price"},[t._v("￥"+t._s(e.goods.skuInfo.goods_price))]),s("span",{staticClass:"quatity"},[t._v("x"+t._s(e.goods_num))])])])})),s("section",{staticClass:"order-summary"},[s("h2",{staticClass:"section-title"},[t._v("订单总金额")]),s("p",{staticClass:"total-amount"},[t._v("总金额: "+t._s(t.total)+" 元")]),s("p",{staticClass:"shipping-fee"},[t._v("配送费用: "+t._s(t.shippingFee)+" 元")]),s("van-coupon-cell",{attrs:{coupons:t.coupons.available,"chosen-coupon":t.coupons.chosenCoupon},on:{click:function(s){t.showList=!0}}}),s("van-popup",{staticStyle:{height:"90%","padding-top":"4px"},attrs:{round:"",position:"bottom"},model:{value:t.showList,callback:function(s){t.showList=s},expression:"showList"}},[s("van-coupon-list",{attrs:{coupons:t.coupons.available,"chosen-coupon":t.coupons.chosenCoupon,"disabled-coupons":t.coupons.disabled},on:{change:t.onChange,exchange:t.onExchange}})],1),s("p",{staticClass:"payable-amount"},[t._v("实付金额: "+t._s(t.payableAmount)+" 元")])],1),s("div",{staticStyle:{"text-align":"center","font-weight":"bold"}},[t._v("支付方式")]),s("van-cell",{attrs:{"is-link":"",title:"支付方式"},on:{click:function(s){t.payment.showPayment=!0}}}),s("van-action-sheet",{attrs:{actions:t.payment.actions},on:{select:t.onSelect},model:{value:t.payment.showPayment,callback:function(s){t.$set(t.payment,"showPayment",s)},expression:"payment.showPayment"}}),s("section",{staticClass:"seller-message"},[s("h2",{staticClass:"section-title"},[t._v("卖家留言")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.sellerMessage,expression:"sellerMessage"}],staticClass:"message-input",attrs:{placeholder:"请输入您的留言"},domProps:{value:t.sellerMessage},on:{input:function(s){s.target.composing||(t.sellerMessage=s.target.value)}}})]),s("footer",{staticClass:"footer"},[s("button",{staticClass:"submit-button",on:{click:t.submitOrder}},[t._v("提交订单")])])],2)},n=[],a=(e(4114),e(3120)),i=e(4180),r=e(5353),d=e(4341),u=e(8950),c={name:"sumbit-index",data(){return{address:{first:"联系人",second:"地址"},shippingFee:20,selectedPaymentMethod:"creditCard",sellerMessage:"",coupons:{available:[],disabled:[],chosenCoupon:-1},showList:!1,payment:{actions:[{name:"微信"},{name:"余额"},{name:"支付宝"},{name:"payPal"},{name:"银行卡"}],showPayment:!1},buynow:{product:{goods_image:"",goods_price_min:0},goodsId:"",goodsNum:"",goodsSku:""}}},methods:{goBack(){this.$router.go(-1)},async submitOrder(){if(""!==this.sellerMessage&&void 0!==this.sellerMessage||(this.sellerMessage="尽快发货"),""===this.buynow.goodsId){const t=this.cartIdsAll.map((t=>t)).join(","),s=await(0,i.c)("10","0",0,"cart","10",this.sellerMessage,t);200===s.status&&this.$router.replace("/cart")}else{const t=await(0,i.lV)("10","0",0,"buyNow",10,this.sellerMessage,this.buynow.goodsId,this.buynow.goodsNum,this.buynow.goodsSku);200===t.status&&this.$router.replace("/cart")}},handleClickAddress(){this.$router.push("/addresses")},onChange(t){this.showList=!1,this.coupons.chosenCoupon=t},onExchange(t){},onSelect(t){this.payment.showPayment=!1}},computed:{...(0,r.L8)("cart",["selectedItems","totalPrice","cartIdsAll"]),payableAmount(){let t=this.coupons.available[this.coupons.chosenCoupon];return t=void 0!==t?t.value/100:0,this.total+this.shippingFee-t},total(){return""===this.buynow.goodsId?this.totalPrice:this.buynow.product.goods_price_min*this.buynow.goodsNum}},async created(){if(void 0!==this.$route.query.goodsId){this.buynow={goodsId:this.$route.query.goodsId,goodsNum:this.$route.query.goodsNum,goodsSku:this.$route.query.goodsSku};const{data:{detail:t}}=await(0,u.FH)(this.$route.query.goodsId);this.buynow.product=t}else 0===this.selectedItems.length&&((0,d.A)("订单取消"),this.$router.go(-1));const t=await(0,a.us)();if(0===t.data.defaultId)return(0,d.A)({message:"你还没有收货地址-<",type:"warning"}),void this.$router.replace("/addresses");const s=await(0,a.wT)(t.data.defaultId);this.address.first=s.data.detail.name+" "+s.data.detail.phone,this.address.second=s.data.detail.region.province+s.data.detail.region.city+s.data.detail.region.region+" "+s.data.detail.detail,this.coupons.available=[{available:1,condition:"无使用门槛\n最多优惠12元",reason:"",value:150,name:"优惠券名称",startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"元"}]}},l=c,p=e(1656),g=(0,p.A)(l,o,n,!1,null,"9e9e2344",null),m=g.exports},3120:function(t,s,e){e.d(s,{M6:function(){return l},TK:function(){return n},_G:function(){return d},k$:function(){return r},pM:function(){return a},qg:function(){return c},us:function(){return i},wT:function(){return u}});var o=e(5720);function n(){return o.A.get("/address/list")}function a(){return o.A.get("/region/tree")}function i(){return o.A.get("/address/defaultId")}function r(t,s,e,n){return o.A.post("/address/add",{form:{name:t,phone:s,region:e,detail:n}})}function d(t){return o.A.post("/address/setDefault",{addressId:t})}function u(t){return o.A.get("/address/detail",{params:{addressId:t}})}function c(t,s,e,n,a){return o.A.post("/address/edit",{addressId:t,form:{name:s,phone:e,region:n,detail:a}})}function l(t){return o.A.post("/address/remove",{addressId:t})}},4180:function(t,s,e){e.d(s,{K2:function(){return d},U9:function(){return c},c:function(){return n},k6:function(){return r},lV:function(){return a},lo:function(){return u},vQ:function(){return i}});var o=e(5720);function n(t,s,e,n,a,i,r){return o.A.post("/checkout/submit",{delivery:t,couponId:s,isUsePoints:e,mode:n,payType:a,remark:i,cartIds:r})}function a(t,s,e,n,a,i,r,d,u){return o.A.post("/checkout/submit",{delivery:t,couponId:s,isUsePoints:e,mode:n,payType:a,remark:i,goodsId:r,goodsNum:d,goodsSkuId:u})}function i(){return o.A.get("/order/todoCounts")}function r(t,s){return o.A.get("/order/list",{params:{dataType:t,page:s}})}function d(t){return o.A.get("/order/detail",{params:{orderId:t}})}function u(t){return o.A.post("/order/cancel",{orderId:t})}function c(t){return o.A.post("/order/receipt",{orderId:t})}},8950:function(t,s,e){e.d(s,{FH:function(){return n},b8:function(){return i},my:function(){return a}});var o=e(5720);function n(t){return o.A.get("/goods/detail",{params:{goodsId:t}})}function a(t){return o.A.get("/comment/total",{params:{goodsId:t}})}function i(t,s){return o.A.get("/comment/listRows",{params:{goodsId:t,limit:s}})}}}]);
//# sourceMappingURL=979.020cb61d.js.map