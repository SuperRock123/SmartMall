"use strict";(self["webpackChunksmart_mall"]=self["webpackChunksmart_mall"]||[]).push([[501],{6501:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"addressDetail"},[t("van-nav-bar",{attrs:{title:"地址详情","left-text":"返回","left-arrow":""},on:{"click-left":function(t){return e.$router.go(-1)}}}),t("div",{staticClass:"form-container"},[t("div",{staticClass:"form-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",placeholder:"请输入姓名"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],attrs:{type:"text",placeholder:"请输入电话"},domProps:{value:e.phone},on:{input:function(t){t.target.composing||(e.phone=t.target.value)}}})]),t("addressSelection",{attrs:{regionTree:e.regionTree},on:{selectedRegions:e.handleSelectedRegions}}),t("div",{staticClass:"form-group"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.address,expression:"address"}],attrs:{rows:"4",placeholder:"请输入详细地址"},domProps:{value:e.address},on:{input:function(t){t.target.composing||(e.address=t.target.value)}}})]),t("div",{staticClass:"button-group"},[t("button",{staticClass:"delete-btn",attrs:{type:"button"},on:{click:e.onDelete}},[e._v("删除")]),t("button",{staticClass:"save-btn",attrs:{type:"button"},on:{click:e.onSave}},[e._v("保存")])])],1)],1)},i=[],r=s(3120),a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"selections"},[t("select",{attrs:{id:""},on:{change:e.clickFirstSelection}},e._l(e.regionTree,(function(s,n){return t("option",{key:s.id,domProps:{value:n}},[e._v(e._s(s.name))])})),0),t("select",{attrs:{id:""},on:{change:e.clickSecondSelection}},e._l(e.cityList,(function(s,n){return t("option",{key:s.id,domProps:{value:n}},[e._v(e._s(s.name))])})),0),t("select",{attrs:{id:""},on:{change:e.clickThirdSelection}},e._l(e.regionList,(function(s,n){return t("option",{key:s.id,domProps:{value:n}},[e._v(e._s(s.name))])})),0)])},o=[],d={name:"selections-component",props:["regionTree"],data(){return{provinceIndex:0,cityIndex:0,regionIndex:0}},created(){},watch:{regionTree(e){}},methods:{clickFirstSelection(e){this.provinceIndex=e.target.value},clickSecondSelection(e){this.cityIndex=e.target.value},clickThirdSelection(e){this.regionIndex=e.target.value,this.$emit("selectedRegions",this.region)}},computed:{cityList(){return Object.values(this.regionTree[this.provinceIndex].city)},regionList(){return Object.values(this.cityList[this.cityIndex].region)},region(){return[{value:this.regionTree[this.provinceIndex].id,label:this.regionTree[this.provinceIndex].name},{value:this.cityList[this.cityIndex].id,label:this.cityList[this.cityIndex].name},{value:this.regionList[this.regionIndex].id,label:this.regionList[this.regionIndex].name}]}}},u=d,c=s(1656),l=(0,c.A)(u,a,o,!1,null,null,null),h=l.exports,p=s(8393),g={name:"addressDatail",components:{addressSelection:h},data(){return{regionTree:{},addressInfo:{},name:"",phone:"",address:"",region:{}}},async created(){if("-1"!==this.$route.query.address_id){const e=await(0,r.wT)(this.$route.query.address_id),{address_id:t,name:s,phone:n,detail:i}=e.data.detail,{province:a,city:o,region:d}=e.data.detail.region;this.addressInfo={id:t,name:s,tel:n,isDefault:!1,province:a,city:o,county:d,addressDetail:i},this.name=this.addressInfo.name,this.phone=this.addressInfo.tel,this.address=this.addressInfo.addressDetail}else this.addressInfo.isDefault=!1;const{data:{list:e}}=await(0,r.pM)();this.regionTree=e,this.regionTree=Object.values(this.regionTree)},methods:{onSave(){"-1"!==this.$route.query.address_id?this.updateAddress():this.addAddress()},async onDelete(){if("-1"!==this.$route.query.address_id){const e=await(0,r.M6)(this.$route.query.address_id);200===e.status&&this.$router.go(-1)}else this.$router.go(-1)},async addAddress(){if(this.validateForm()){const e=await(0,r.k$)(this.name,this.phone,this.region,this.address);200===e.status&&this.$router.go(-1)}},async updateAddress(){const e=await(0,r.qg)(this.$route.query.address_id,this.name,this.phone,this.region,this.address);200===e.status&&this.$router.go(-1)},handleSelectedRegions(e){this.region=e},validateForm(){return""===this.name?((0,p.A)("请输入姓名"),!1):""===this.phone?((0,p.A)("请输入电话"),!1):this.region==={}?((0,p.A)("地址有误"),!1):""!==this.address||((0,p.A)("请输入详细地址"),!1)}}},m=g,v=(0,c.A)(m,n,i,!1,null,null,null),f=v.exports},3120:function(e,t,s){s.d(t,{M6:function(){return l},TK:function(){return i},_G:function(){return d},k$:function(){return o},pM:function(){return r},qg:function(){return c},us:function(){return a},wT:function(){return u}});var n=s(5720);function i(){return n.A.get("/address/list")}function r(){return n.A.get("/region/tree")}function a(){return n.A.get("/address/defaultId")}function o(e,t,s,i){return n.A.post("/address/add",{form:{name:e,phone:t,region:s,detail:i}})}function d(e){return n.A.post("/address/setDefault",{addressId:e})}function u(e){return n.A.get("/address/detail",{params:{addressId:e}})}function c(e,t,s,i,r){return n.A.post("/address/edit",{addressId:e,form:{name:t,phone:s,region:i,detail:r}})}function l(e){return n.A.post("/address/remove",{addressId:e})}}}]);
//# sourceMappingURL=501.31bd8e6d.js.map